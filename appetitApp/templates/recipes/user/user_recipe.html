{% extends 'base.html' %} 
{% load static %}
{% block content %}
<div class="lg:container">
  <div class="w-full h-96 bg-blue object-cover rounded-b-[50px] overflow-hidden">
    {% comment %} <img
      src=""
      alt=""
      class="h-full w-full object-cover object-center group-hover:opacity-75"
    /> {% endcomment %}
  </div>
  {% comment %} recipe details {% endcomment %}
<div class="container my-8 px-6">
    <h2 class="font-serif text-lg mb-4">{{ recipe.name }}</h2>
    <p class="text-sm">{{ recipe.description }}</p>
  </div>
</div> 

{% comment %} ingredients list {% endcomment %}

<form class="container" id="ingredient-form" action="{% url "add_ingredient" recipe.id  %}" method="post">
  {% csrf_token %}
  {{ ingredient_form }}
  <button type="submit">add ingredient</button>
</form>

<div class="container text-sm my-8 px-6">
  <h2 class="font-serif mb-4">Ingredients</h2>
  <div class="grid grid-cols-2 gap-y-1">

    {% for ingredient in recipe.ingredients_set.all %}
      <p>{{ ingredient.amount }} {{ ingredient.measurement }} {{ ingredient.ingredient }}</p>
    {% endfor %}
  </div>
</div> 
{% comment %} descriptions {% endcomment %}
<div class="container my-8 px-6">
  <h2 class="font-serif mb-4">
    Instructions
  </h2>

  <form id="add-steps" action="{% url "add_steps" recipe.id %}" method="post">
    {% csrf_token %}
    {{ steps_form }}
    <button type="submit">add step</button>
  </form>
{% for step in recipe.steps_set.all %}
  <div class="mb-2 bg-card-bg rounded-lg p-2">
    <p class="text-sm font-bold font-serif pb-2">Step</p>
    <p class="text-sm">{{ step.instructions }}</p>
  </div>
  {% endfor %}
</div>


<div class="mx-6 pt-4 border-b border-card-bg">
</div>

{% comment %}reviews{% endcomment %}
{% for review in recipe.review_set.all %}
  <div class="mb-2 bg-card-bg rounded-lg p-2">
    <p class="text-sm">{{ review.text }}</p> 
    <form action="{% url 'reviews_delete' recipe_id=recipe.id pk=review.id %}" method="POST">
      {% csrf_token %}
      <button class="text-red-600 hover:underline" type="submit">Delete Review</button>
    </form>
    <!-- <form action="{% url 'reviews_edit' recipe_id=recipe.id pk=review.id %}" method="GET"> -->
    <form action="{% url 'reviews_edit' recipe_id=recipe.id pk=review.id %}" method="GET">
      <button class="text-blue-600 hover:underline" type="submit">Edit Review</button>
    </form>
  </div>
  <p class="text-xs text-gray-500">Review submitted at {{ review.created_at|date:"Y-m-d H:i:s" }}</p>
  {% endfor %}
<div class="container mt-10">
  <form action="{% url "add_review" recipe.id %}" method="POST">
    {% csrf_token %}
    {{ review_form }}
    <div class="flex justify-end">
      <button class="inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10" type="submit">add comment</button>
    </div>
    </form>
</div>
</div> 

<script src="{% static "js/recipeFormControls.js" %}"></script>
{% endblock %}

